Namespace(batch_size=128, depth=[784, 400, 400], drop_rate=0.2, epochs=100, evaluate=False, gammas=[0.1, 0.1], log_file='mlp_mnist_lr0.1_wd1e-4.log', lr=0.1, model='mlp_mnist', momentum=0.9, resume='', save_path='./save/mlp_mnist/mlp_mnist_lr0.1_wd1e-4_LRstepTrue/', schedule=[60, 80], use_cuda=True, weight_decay=0.0001)
==> Building model..

MLP(
  (mlp): Sequential(
    (0): Linear(in_features=784, out_features=400, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=400, out_features=400, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.2, inplace=False)
  )
  (classifier): Linear(in_features=400, out_features=10, bias=True)
)
----  --------  ---------  --------  ----------  ---------  ----------
  ep        lr    tr_loss    tr_acc    val_loss    val_acc    best_acc
----  --------  ---------  --------  ----------  ---------  ----------
   1    0.1000     0.3754   88.2700      0.1403    95.8000     95.8000
   2    0.1000     0.1343   95.8480      0.0940    97.1600     97.1600
   3    0.1000     0.0988   96.9600      0.0845    97.4500     97.4500
   4    0.1000     0.0813   97.4120      0.0770    97.7000     97.7000
   5    0.1000     0.0692   97.7680      0.0792    97.7400     97.7400
   6    0.1000     0.0589   98.1260      0.0731    97.9000     97.9000
   7    0.1000     0.0547   98.2280      0.0721    97.8700     97.9000
   8    0.1000     0.0477   98.4300      0.0777    97.8500     97.9000
   9    0.1000     0.0400   98.6800      0.0764    97.8100     97.9000
  10    0.1000     0.0418   98.5680      0.0741    97.9600     97.9600
  11    0.1000     0.0377   98.7640      0.0734    98.0400     98.0400
  12    0.1000     0.0338   98.8200      0.0734    97.9700     98.0400
  13    0.1000     0.0344   98.8680      0.0786    97.9400     98.0400
  14    0.1000     0.0289   98.9940      0.0831    97.8800     98.0400
  15    0.1000     0.0279   99.0660      0.0708    98.1200     98.1200
  16    0.1000     0.0248   99.1880      0.0714    98.1500     98.1500
  17    0.1000     0.0260   99.1000      0.0686    98.2400     98.2400
  18    0.1000     0.0279   99.0860      0.0654    98.2300     98.2400
  19    0.1000     0.0249   99.1240      0.0676    98.2700     98.2700
  20    0.1000     0.0222   99.2820      0.0720    98.2200     98.2700
  21    0.1000     0.0232   99.2100      0.0760    98.1100     98.2700
  22    0.1000     0.0222   99.2440      0.0677    98.1800     98.2700
  23    0.1000     0.0212   99.2660      0.0702    98.3000     98.3000
  24    0.1000     0.0206   99.3020      0.0779    97.9700     98.3000
  25    0.1000     0.0225   99.2840      0.0701    98.1200     98.3000
  26    0.1000     0.0218   99.2860      0.0735    98.1000     98.3000
  27    0.1000     0.0225   99.2220      0.0719    98.1700     98.3000
  28    0.1000     0.0234   99.2300      0.0682    98.1200     98.3000
  29    0.1000     0.0224   99.2300      0.0637    98.3700     98.3700
  30    0.1000     0.0196   99.3760      0.0629    98.2300     98.3700
  31    0.1000     0.0181   99.3900      0.0798    98.0400     98.3700
  32    0.1000     0.0191   99.3560      0.0652    98.2800     98.3700
  33    0.1000     0.0163   99.4980      0.0734    98.1800     98.3700
  34    0.1000     0.0170   99.4000      0.0703    98.2900     98.3700
  35    0.1000     0.0215   99.2520      0.0696    98.2100     98.3700
  36    0.1000     0.0210   99.3220      0.0713    98.0900     98.3700
  37    0.1000     0.0205   99.3260      0.0688    98.2700     98.3700
  38    0.1000     0.0177   99.4480      0.0697    98.2300     98.3700
  39    0.1000     0.0173   99.4340      0.0673    98.2300     98.3700
  40    0.1000     0.0191   99.3880      0.0647    98.3600     98.3700
  41    0.1000     0.0169   99.4520      0.0754    98.1700     98.3700
  42    0.1000     0.0164   99.4660      0.0718    98.3100     98.3700
  43    0.1000     0.0201   99.3260      0.0703    98.2200     98.3700
  44    0.1000     0.0153   99.5200      0.0757    97.9300     98.3700
  45    0.1000     0.0192   99.3380      0.0788    98.0900     98.3700
  46    0.1000     0.0204   99.3080      0.0848    97.8300     98.3700
  47    0.1000     0.0217   99.2640      0.0655    98.4500     98.4500
  48    0.1000     0.0166   99.4480      0.0673    98.3600     98.4500
  49    0.1000     0.0175   99.4340      0.0668    98.3800     98.4500
  50    0.1000     0.0163   99.4920      0.0675    98.4500     98.4500
  51    0.1000     0.0160   99.4620      0.0718    98.2100     98.4500
  52    0.1000     0.0181   99.4080      0.0832    97.9900     98.4500
  53    0.1000     0.0172   99.4280      0.0635    98.2800     98.4500
  54    0.1000     0.0154   99.5120      0.0666    98.3900     98.4500
  55    0.1000     0.0165   99.4800      0.0666    98.2300     98.4500
  56    0.1000     0.0160   99.5040      0.0748    98.0800     98.4500
  57    0.1000     0.0189   99.3600      0.0672    98.2000     98.4500
  58    0.1000     0.0182   99.3980      0.0693    98.2400     98.4500
  59    0.1000     0.0180   99.3800      0.0660    98.2400     98.4500
  60    0.1000     0.0147   99.4900      0.0630    98.3800     98.4500
  61    0.0100     0.0065   99.8300      0.0566    98.5900     98.5900
  62    0.0100     0.0047   99.8860      0.0566    98.5900     98.5900
  63    0.0100     0.0040   99.9260      0.0553    98.6700     98.6700
  64    0.0100     0.0038   99.9200      0.0559    98.6300     98.6700
  65    0.0100     0.0035   99.9300      0.0568    98.6500     98.6700
  66    0.0100     0.0034   99.9380      0.0559    98.6700     98.6700
  67    0.0100     0.0031   99.9420      0.0558    98.6900     98.6900
  68    0.0100     0.0028   99.9560      0.0556    98.6900     98.6900
  69    0.0100     0.0031   99.9360      0.0555    98.6600     98.6900
  70    0.0100     0.0028   99.9500      0.0556    98.6500     98.6900
  71    0.0100     0.0030   99.9440      0.0552    98.6400     98.6900
  72    0.0100     0.0028   99.9440      0.0563    98.6000     98.6900
  73    0.0100     0.0030   99.9460      0.0559    98.6200     98.6900
  74    0.0100     0.0026   99.9540      0.0570    98.5500     98.6900
  75    0.0100     0.0029   99.9500      0.0555    98.6300     98.6900
  76    0.0100     0.0031   99.9140      0.0551    98.6400     98.6900
  77    0.0100     0.0026   99.9520      0.0549    98.7000     98.7000
  78    0.0100     0.0028   99.9480      0.0545    98.6900     98.7000
  79    0.0100     0.0024   99.9700      0.0545    98.6600     98.7000
  80    0.0100     0.0026   99.9680      0.0544    98.6800     98.7000
  81    0.0010     0.0024   99.9600      0.0545    98.6700     98.7000
  82    0.0010     0.0027   99.9480      0.0547    98.6600     98.7000
  83    0.0010     0.0026   99.9640      0.0548    98.6500     98.7000
  84    0.0010     0.0023   99.9620      0.0548    98.6800     98.7000
  85    0.0010     0.0025   99.9560      0.0548    98.6700     98.7000
  86    0.0010     0.0023   99.9700      0.0547    98.6600     98.7000
  87    0.0010     0.0026   99.9520      0.0547    98.6700     98.7000
  88    0.0010     0.0024   99.9620      0.0547    98.6900     98.7000
  89    0.0010     0.0028   99.9440      0.0547    98.6700     98.7000
  90    0.0010     0.0026   99.9500      0.0547    98.6800     98.7000
  91    0.0010     0.0024   99.9740      0.0547    98.6700     98.7000
  92    0.0010     0.0025   99.9600      0.0548    98.6900     98.7000
  93    0.0010     0.0023   99.9720      0.0547    98.6800     98.7000
  94    0.0010     0.0026   99.9580      0.0548    98.6800     98.7000
  95    0.0010     0.0024   99.9720      0.0549    98.6500     98.7000
  96    0.0010     0.0023   99.9680      0.0546    98.6600     98.7000
  97    0.0010     0.0024   99.9700      0.0545    98.6800     98.7000
  98    0.0010     0.0023   99.9720      0.0546    98.6600     98.7000
  99    0.0010     0.0026   99.9640      0.0545    98.6500     98.7000
 100    0.0010     0.0026   99.9500      0.0545    98.6800     98.7000
Test accuracy: 98.81
