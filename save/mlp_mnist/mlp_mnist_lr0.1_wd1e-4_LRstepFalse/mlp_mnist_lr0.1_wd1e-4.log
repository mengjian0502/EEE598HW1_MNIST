Namespace(batch_size=128, depth=[784, 400, 400], drop_rate=0.2, epochs=100, evaluate=False, gammas=[1.0, 1.0], log_file='mlp_mnist_lr0.1_wd1e-4.log', lr=0.1, model='mlp_mnist', momentum=0.9, resume='', save_path='./save/mlp_mnist/mlp_mnist_lr0.1_wd1e-4_LRstepFalse/', schedule=[60, 80], use_cuda=True, weight_decay=0.0001)
==> Building model..

MLP(
  (mlp): Sequential(
    (0): Linear(in_features=784, out_features=400, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=400, out_features=400, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.2, inplace=False)
  )
  (classifier): Linear(in_features=400, out_features=10, bias=True)
)
----  --------  ---------  --------  ---------  --------  ----------
  ep        lr    tr_loss    tr_acc    te_loss    te_acc    best_acc
----  --------  ---------  --------  ---------  --------  ----------
   1    0.1000     0.2832   91.3567     0.1234   96.2500     96.2500
   2    0.1000     0.1376   95.9183     0.1006   97.0600     97.0600
   3    0.1000     0.1080   96.8067     0.1049   97.0100     97.0600
   4    0.1000     0.0939   97.1833     0.1043   97.0900     97.0900
   5    0.1000     0.0828   97.4667     0.0971   97.4000     97.4000
   6    0.1000     0.0754   97.6250     0.0947   97.2400     97.4000
   7    0.1000     0.0654   98.0100     0.0869   97.4700     97.4700
   8    0.1000     0.0662   98.0033     0.0871   97.5100     97.5100
   9    0.1000     0.0579   98.1500     0.0758   97.9500     97.9500
  10    0.1000     0.0575   98.1833     0.1004   97.4000     97.9500
  11    0.1000     0.0561   98.2300     0.0863   97.6100     97.9500
  12    0.1000     0.0475   98.5517     0.0702   98.0800     98.0800
  13    0.1000     0.0506   98.4900     0.0931   97.4900     98.0800
  14    0.1000     0.0477   98.5067     0.0838   97.7900     98.0800
  15    0.1000     0.0492   98.4683     0.0842   97.7500     98.0800
  16    0.1000     0.0469   98.5783     0.0754   97.8500     98.0800
  17    0.1000     0.0397   98.7317     0.0750   98.1400     98.1400
  18    0.1000     0.0390   98.7683     0.0753   98.0900     98.1400
  19    0.1000     0.0416   98.7067     0.0937   97.7600     98.1400
  20    0.1000     0.0405   98.7350     0.0858   97.7000     98.1400
  21    0.1000     0.0366   98.8600     0.0723   98.2600     98.2600
  22    0.1000     0.0388   98.7733     0.0787   98.0500     98.2600
  23    0.1000     0.0373   98.8433     0.0760   98.1500     98.2600
  24    0.1000     0.0375   98.8317     0.0787   98.0100     98.2600
  25    0.1000     0.0385   98.7767     0.0816   97.9800     98.2600
  26    0.1000     0.0356   98.8950     0.0866   98.0300     98.2600
  27    0.1000     0.0357   98.9050     0.0915   97.8800     98.2600
  28    0.1000     0.0378   98.8133     0.0871   97.9700     98.2600
  29    0.1000     0.0365   98.9033     0.0806   97.9100     98.2600
  30    0.1000     0.0370   98.8667     0.0812   98.0200     98.2600
  31    0.1000     0.0363   98.8683     0.0780   98.0600     98.2600
  32    0.1000     0.0325   99.0300     0.0864   97.9500     98.2600
  33    0.1000     0.0274   99.1433     0.0812   98.1300     98.2600
  34    0.1000     0.0306   99.0717     0.0749   98.1300     98.2600
  35    0.1000     0.0365   98.8950     0.0798   98.1000     98.2600
  36    0.1000     0.0344   98.9667     0.0636   98.2500     98.2600
  37    0.1000     0.0322   98.9633     0.0749   98.2400     98.2600
  38    0.1000     0.0320   99.0133     0.0723   98.2000     98.2600
  39    0.1000     0.0305   99.0100     0.0740   98.0800     98.2600
  40    0.1000     0.0339   98.9417     0.0776   98.0400     98.2600
  41    0.1000     0.0316   98.9617     0.0888   97.7500     98.2600
  42    0.1000     0.0318   98.9800     0.0767   98.0400     98.2600
  43    0.1000     0.0322   98.9917     0.0766   98.1300     98.2600
  44    0.1000     0.0305   99.0367     0.0659   98.2100     98.2600
  45    0.1000     0.0307   99.0167     0.0724   98.0700     98.2600
  46    0.1000     0.0306   99.0233     0.0911   97.6600     98.2600
  47    0.1000     0.0338   98.9533     0.0760   98.0500     98.2600
  48    0.1000     0.0282   99.0583     0.0711   98.2900     98.2900
  49    0.1000     0.0304   99.0550     0.0830   98.1000     98.2900
  50    0.1000     0.0264   99.1733     0.0689   98.2800     98.2900
  51    0.1000     0.0246   99.2133     0.0792   98.0400     98.2900
  52    0.1000     0.0311   99.0400     0.0819   97.9000     98.2900
  53    0.1000     0.0383   98.8067     0.0701   98.2600     98.2900
  54    0.1000     0.0262   99.1733     0.0660   98.3800     98.3800
  55    0.1000     0.0270   99.1317     0.0621   98.4000     98.4000
  56    0.1000     0.0277   99.0967     0.0665   98.2400     98.4000
  57    0.1000     0.0332   98.9500     0.0864   97.9300     98.4000
  58    0.1000     0.0348   98.8900     0.0687   98.1200     98.4000
  59    0.1000     0.0336   98.9333     0.0744   98.2300     98.4000
  60    0.1000     0.0306   99.0133     0.0795   98.1700     98.4000
  61    0.1000     0.0270   99.1550     0.0707   98.3000     98.4000
  62    0.1000     0.0257   99.1917     0.0777   98.2000     98.4000
  63    0.1000     0.0326   98.9600     0.0783   98.1200     98.4000
  64    0.1000     0.0300   99.0800     0.0763   98.1300     98.4000
  65    0.1000     0.0269   99.1983     0.0728   98.1300     98.4000
  66    0.1000     0.0265   99.1383     0.0705   98.3100     98.4000
  67    0.1000     0.0320   98.9800     0.0677   98.2700     98.4000
  68    0.1000     0.0295   99.0650     0.0896   97.8800     98.4000
  69    0.1000     0.0303   99.0683     0.0723   98.1800     98.4000
  70    0.1000     0.0301   99.0533     0.0748   98.1200     98.4000
  71    0.1000     0.0307   99.0367     0.0760   98.2100     98.4000
  72    0.1000     0.0303   99.0333     0.0814   98.0500     98.4000
  73    0.1000     0.0281   99.1033     0.0767   98.0000     98.4000
  74    0.1000     0.0265   99.1733     0.0635   98.4000     98.4000
  75    0.1000     0.0305   99.0600     0.0752   98.0900     98.4000
  76    0.1000     0.0287   99.0667     0.0722   98.3200     98.4000
  77    0.1000     0.0274   99.1517     0.0798   98.2200     98.4000
  78    0.1000     0.0286   99.0967     0.0775   97.9900     98.4000
  79    0.1000     0.0285   99.1467     0.0823   98.0900     98.4000
  80    0.1000     0.0242   99.2650     0.0719   98.0600     98.4000
  81    0.1000     0.0250   99.2033     0.0807   97.9900     98.4000
  82    0.1000     0.0275   99.0883     0.0831   98.0500     98.4000
  83    0.1000     0.0278   99.0833     0.0745   98.1800     98.4000
  84    0.1000     0.0279   99.1533     0.0735   98.3700     98.4000
  85    0.1000     0.0352   98.9100     0.0706   98.2500     98.4000
  86    0.1000     0.0297   99.0383     0.0897   97.8800     98.4000
  87    0.1000     0.0298   99.1300     0.0782   97.9900     98.4000
  88    0.1000     0.0261   99.1733     0.0755   98.2100     98.4000
  89    0.1000     0.0277   99.1617     0.0852   97.9900     98.4000
  90    0.1000     0.0249   99.2267     0.0749   98.2000     98.4000
  91    0.1000     0.0258   99.1917     0.0779   98.1500     98.4000
  92    0.1000     0.0260   99.2100     0.0640   98.3400     98.4000
  93    0.1000     0.0255   99.2150     0.0847   98.0200     98.4000
  94    0.1000     0.0347   98.9483     0.0799   97.9100     98.4000
  95    0.1000     0.0287   99.1300     0.0733   98.3600     98.4000
  96    0.1000     0.0276   99.1033     0.0773   98.0900     98.4000
  97    0.1000     0.0286   99.0983     0.0870   97.9000     98.4000
  98    0.1000     0.0276   99.0983     0.0741   98.2000     98.4000
  99    0.1000     0.0287   99.0950     0.0713   98.1900     98.4000
 100    0.1000     0.0269   99.1867     0.0774   98.1000     98.4000
Namespace(batch_size=128, depth=[784, 400, 400], drop_rate=0.2, epochs=100, evaluate=False, gammas=[1.0, 1.0], log_file='mlp_mnist_lr0.1_wd1e-4.log', lr=0.1, model='mlp_mnist', momentum=0.9, resume='', save_path='./save/mlp_mnist/mlp_mnist_lr0.1_wd1e-4_LRstepFalse/', schedule=[60, 80], use_cuda=True, weight_decay=0.0001)
==> Building model..

MLP(
  (mlp): Sequential(
    (0): Linear(in_features=784, out_features=400, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=400, out_features=400, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.2, inplace=False)
  )
  (classifier): Linear(in_features=400, out_features=10, bias=True)
)
----  --------  ---------  --------  ----------  ---------  ----------
  ep        lr    tr_loss    tr_acc    val_loss    val_acc    best_acc
----  --------  ---------  --------  ----------  ---------  ----------
   1    0.1000     0.3755   88.5860      0.1410    95.6400     95.6400
   2    0.1000     0.1337   95.8300      0.1117    96.8000     96.8000
   3    0.1000     0.0970   96.9740      0.0893    97.4000     97.4000
   4    0.1000     0.0784   97.5860      0.0785    97.5800     97.5800
   5    0.1000     0.0671   97.8720      0.0764    97.7000     97.7000
   6    0.1000     0.0617   97.9880      0.0813    97.6300     97.7000
   7    0.1000     0.0534   98.3020      0.0726    97.8200     97.8200
   8    0.1000     0.0428   98.6300      0.0713    98.1200     98.1200
   9    0.1000     0.0419   98.6640      0.0680    98.2400     98.2400
  10    0.1000     0.0407   98.6000      0.0724    98.0300     98.2400
  11    0.1000     0.0383   98.6640      0.0813    97.7500     98.2400
  12    0.1000     0.0330   98.9280      0.0719    98.0100     98.2400
  13    0.1000     0.0302   99.0160      0.0741    97.9800     98.2400
  14    0.1000     0.0329   98.8880      0.0751    97.9500     98.2400
  15    0.1000     0.0278   99.0440      0.0706    98.0900     98.2400
  16    0.1000     0.0263   99.1100      0.0675    98.1900     98.2400
  17    0.1000     0.0275   99.1080      0.0755    97.9400     98.2400
  18    0.1000     0.0236   99.2420      0.0873    97.9300     98.2400
  19    0.1000     0.0265   99.1280      0.0708    98.1600     98.2400
  20    0.1000     0.0249   99.1420      0.0729    98.2800     98.2800
  21    0.1000     0.0214   99.2800      0.0682    98.2900     98.2900
  22    0.1000     0.0197   99.3460      0.0705    98.2200     98.2900
  23    0.1000     0.0213   99.2460      0.0688    98.1400     98.2900
  24    0.1000     0.0227   99.2700      0.0692    98.1900     98.2900
  25    0.1000     0.0227   99.2060      0.0709    98.1800     98.2900
  26    0.1000     0.0209   99.2580      0.0701    98.0600     98.2900
  27    0.1000     0.0180   99.4140      0.0810    98.0800     98.2900
  28    0.1000     0.0224   99.2800      0.0770    97.9700     98.2900
  29    0.1000     0.0226   99.2440      0.0696    97.9700     98.2900
  30    0.1000     0.0216   99.2740      0.0643    98.3500     98.3500
  31    0.1000     0.0181   99.4120      0.0667    98.2000     98.3500
  32    0.1000     0.0181   99.3960      0.0675    98.2400     98.3500
  33    0.1000     0.0198   99.3080      0.0636    98.2400     98.3500
  34    0.1000     0.0195   99.3420      0.0670    98.3000     98.3500
  35    0.1000     0.0187   99.3380      0.0734    98.1800     98.3500
  36    0.1000     0.0184   99.3840      0.0668    98.3600     98.3600
  37    0.1000     0.0154   99.5060      0.0664    98.3800     98.3800
  38    0.1000     0.0196   99.3500      0.0666    98.0700     98.3800
  39    0.1000     0.0191   99.3940      0.0735    98.2000     98.3800
  40    0.1000     0.0169   99.4520      0.0637    98.3200     98.3800
  41    0.1000     0.0165   99.4600      0.0721    98.1300     98.3800
  42    0.1000     0.0153   99.5200      0.0790    97.9500     98.3800
  43    0.1000     0.0199   99.3500      0.0652    98.1600     98.3800
  44    0.1000     0.0157   99.4680      0.0624    98.4700     98.4700
  45    0.1000     0.0181   99.4140      0.0777    98.1100     98.4700
  46    0.1000     0.0176   99.4260      0.0694    98.2500     98.4700
  47    0.1000     0.0164   99.4340      0.0652    98.2900     98.4700
  48    0.1000     0.0169   99.4580      0.0657    98.2900     98.4700
  49    0.1000     0.0186   99.3500      0.0677    98.2700     98.4700
  50    0.1000     0.0192   99.3720      0.0627    98.2800     98.4700
  51    0.1000     0.0184   99.3800      0.0718    98.0400     98.4700
  52    0.1000     0.0153   99.5140      0.0689    98.3500     98.4700
  53    0.1000     0.0156   99.4840      0.0770    98.0800     98.4700
  54    0.1000     0.0176   99.4400      0.0645    98.2900     98.4700
  55    0.1000     0.0180   99.4240      0.0783    97.9200     98.4700
  56    0.1000     0.0178   99.3920      0.0665    98.2300     98.4700
  57    0.1000     0.0193   99.3260      0.0631    98.3900     98.4700
  58    0.1000     0.0162   99.4560      0.0657    98.3400     98.4700
  59    0.1000     0.0174   99.4540      0.0610    98.4200     98.4700
  60    0.1000     0.0147   99.5400      0.0641    98.3100     98.4700
  61    0.1000     0.0149   99.5380      0.0643    98.3600     98.4700
  62    0.1000     0.0162   99.4680      0.0714    98.3000     98.4700
  63    0.1000     0.0152   99.5280      0.0605    98.5400     98.5400
  64    0.1000     0.0148   99.5160      0.0582    98.5700     98.5700
  65    0.1000     0.0156   99.4680      0.0642    98.1500     98.5700
  66    0.1000     0.0189   99.3700      0.0759    98.1000     98.5700
  67    0.1000     0.0175   99.3960      0.0647    98.2800     98.5700
  68    0.1000     0.0180   99.4460      0.0702    98.0900     98.5700
  69    0.1000     0.0201   99.3160      0.0712    98.0800     98.5700
  70    0.1000     0.0170   99.4440      0.0600    98.4500     98.5700
  71    0.1000     0.0154   99.5040      0.0737    98.0700     98.5700
  72    0.1000     0.0143   99.5420      0.0617    98.4500     98.5700
  73    0.1000     0.0168   99.4500      0.0695    98.1600     98.5700
  74    0.1000     0.0139   99.5660      0.0745    98.0000     98.5700
  75    0.1000     0.0158   99.5140      0.0659    98.2400     98.5700
  76    0.1000     0.0152   99.5000      0.0617    98.3000     98.5700
  77    0.1000     0.0165   99.4140      0.0707    98.2300     98.5700
  78    0.1000     0.0165   99.4560      0.0629    98.2600     98.5700
  79    0.1000     0.0185   99.4180      0.0692    98.1100     98.5700
  80    0.1000     0.0161   99.4620      0.0805    98.1200     98.5700
  81    0.1000     0.0158   99.4880      0.0597    98.4600     98.5700
  82    0.1000     0.0167   99.4720      0.0583    98.3600     98.5700
  83    0.1000     0.0171   99.4340      0.0631    98.3900     98.5700
  84    0.1000     0.0154   99.5060      0.0656    98.2000     98.5700
  85    0.1000     0.0164   99.4680      0.0669    98.3800     98.5700
  86    0.1000     0.0134   99.6080      0.0627    98.3600     98.5700
  87    0.1000     0.0143   99.5300      0.0613    98.4100     98.5700
  88    0.1000     0.0177   99.3980      0.0734    98.1200     98.5700
  89    0.1000     0.0167   99.4360      0.0677    98.1400     98.5700
  90    0.1000     0.0160   99.4760      0.0657    98.3300     98.5700
  91    0.1000     0.0171   99.3960      0.0650    98.2800     98.5700
  92    0.1000     0.0129   99.6020      0.0634    98.3700     98.5700
  93    0.1000     0.0127   99.6120      0.0686    98.1500     98.5700
  94    0.1000     0.0158   99.4780      0.0685    98.3000     98.5700
  95    0.1000     0.0182   99.4160      0.0620    98.3400     98.5700
  96    0.1000     0.0182   99.4100      0.0674    98.2800     98.5700
  97    0.1000     0.0177   99.4340      0.0718    98.1800     98.5700
  98    0.1000     0.0152   99.5180      0.0658    98.3100     98.5700
  99    0.1000     0.0147   99.5200      0.0693    98.2300     98.5700
 100    0.1000     0.0185   99.3800      0.0671    98.1600     98.5700
Test accuracy: 98.47
